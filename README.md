# EREG-CRC Analysis Code

Code repository for the paper: **"Multi-transcriptomic Analysis Reveals that EREG-driven TME Crosstalk Defines Anti-EGFR Response in Colorectal Cancer"**

[![DOI](https://zenodo.org/badge/969441135.svg)](https://doi.org/10.5281/zenodo.15298304)

## Overview

This repository contains the R scripts and associated files used to perform the single-cell RNA-seq, spatial transcriptomics (Visium), and integrated multi-omics analyses presented in the paper. The study investigates the role of Epiregulin (EREG) and the tumor microenvironment (TME) in determining the response to anti-EGFR therapy in colorectal cancer (CRC), analyzing differences based on tumor sidedness and identifying key cellular interactions within the EREG/EGFR/CSF signaling axis.

## Repository Structure

* `/Fig1_Integrative analysis of scRNA-seq.Rmd`: Code to perform initial data integration, clustering, cell type annotation, and generate figures for Figure 1 and Extended Data Figure 1.
* `/Fig2_EGFR eligibility reflects cancer cell characteristics.Rmd`: Code for epithelial cell subclustering, inferCNV, DEG analysis, pseudobulk analysis, and CIBERSORTx analysis related to Figure 2 and Extended Data Figure 2, 3a.
* `/Fig3_EREG plays a central role in the cell-cell interaction network.Rmd`: Code for EREG expression analysis, CellChat comparison, NicheNet analysis (Epithelial -> Fibroblast), related to Figure 3 and Extended Data Figure 3b-d.
* `/Fig4_Interaction between cancer cells and non-myCAFs.Rmd`: Code for fibroblast/pericyte subclustering, CAF annotation, GSEA, CellChat (detailed CAF subtypes), CIBERSORTx (CAF subtypes), related to Figure 4 and Extended Data Figure 4.
* `/Fig5_TAM and TAMo are classified into functionally three subtypes.Rmd`: Code for myeloid cell subclustering, TAM/TAMo annotation, CellChat (TAM/TAMo subtypes), GSEA, Monocle3 trajectory analysis, related to Figure 5 and Extended Data Figure 5.
* `/Fig6_Validation using spatial transcriptomics.Rmd`: Code for Visium data processing, CytoSPACE analysis, tumor proximity analysis, AUCell scoring, and co-localization analysis related to Figure 6 and Extended Data Figure 6.
* `README.md`: This file.

## Installation

The analysis was performed using R version 4.4.0. Key R packages required include:

* Seurat (v5.2.1)
* infercnv (v1.22.0)
* DESeq2 (v1.46.0)
* sva (v3.54.0)
* limma (v3.62.2)
* CIBERSORTx (https://cibersortx.stanford.edu/)
* CellChat (v2.1.2)
* NicheNet (v2.1.7)
* AUCell (v1.28.0)
* clusterProfiler (v4.14.4)
* Monocle3 (v1.3.7)
* CytoSPACE (https://github.com/digitalcytometry/cytospace)

## Usage / Workflow

1.  **Data Preparation:** Download necessary public data (see Data Availability section) and place them in the expected directory structure (modify paths in scripts as needed). Ensure the clinical metadata file (`primary_scRNA-seq_clinical_metadata.xlsx`) is available.
2.  **Run Scripts:** Execute the R Markdown scripts sequentially:
3.  **External Tools:** Note that CIBERSORTx and CytoSPACE analyses require running external tools/web services using intermediate files generated by the R scripts. Please refer to their respective documentations for execution details.

## Data Availability

* **scRNA-seq:**
    * GSE200997: Available from GEO (https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE200997)
    * KUL3, KUL5, CRC-SG1, CRC-SG2, SMC: Available from Synapse (https://www.synapse.org/#!Synapse:syn26844071)
* **Visium Spatial Transcriptomics (ST):**
    * The Space Ranger output, including processed count matrices and histological images, for the Visium ST data generated and analyzed in this study has been deposited on Zenodo and is publicly available (DOI: 10.5281/zenodo.7551712).
* **TCGA:**
    * This study utilized RNA sequencing (gene expression) and somatic mutation (MAF) data from The Cancer Genome Atlas (TCGA) Colon Adenocarcinoma (COAD) and Rectum Adenocarcinoma (READ) projects. These data are publicly available through the Genomic Data Commons (GDC) portal (https://portal.gdc.cancer.gov/).

## License

This project is licensed under the Apache License 2.0. See the `LICENSE` file for details.

## Contact

For questions regarding the code or analysis, please contact Atsuki Taniguchi at pe9w3u9l@s.okayama-u.ac.jp.

## Citation

If you use this code or data, please cite our paper:ã€€To be added upon publication
